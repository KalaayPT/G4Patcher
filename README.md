# Pokemon Gen 4 Code Injection Patcher

This is a small thing ive written up to easily distribute .asm patches for code injecting things such as EV+IV-checking and Portable PC routines, because i was tired of explaining and writing out every patch separately.

This program is purely cli. It prompts you to select an unpacked ROM folder (such as one generated by [DSPRE](https://github.com/Mixone-FinallyHere/DS-Pokemon-Rom-Editor/tree/v1.13.1-beta)), then one of the included patches, then checks for:
1. Is the patch compatible with your game? (by comparing game header with patch name, so if you want to contribute your own patches, make sure to label your patches corrrectly)
2. Can you even inject the patch, i.e. is your arm9 expanded?
3. Is there free space in the synthOverlay and where is said space

After checking these things, it adjusts the patch file with the corrected injection address and runs the patch through armips.

An [armips](https://github.com/Kingcom/armips) binary is bundled into the release, so no need to install anything!

## Usage:

1. Download the latest [release](https://github.com/KalaayPT/g4patcher/releases)
2. Run G4Patcher
3. Select your unpacked ROM folder
4. Select the patch
5. If everything is fine, youll get a confirmation message, if not, you'll get a message telling you what the issue is
6. Press Enter to close

## Limitations:

- The program doesn't check if the patch is already applied, so if you apply a patch twice, it will duplicate the previous one. The patch will still work, but more space in you synthOverlay will be used up.
- The program doesnt check compression either (yet), so make sure that the hook overlay required by the patch is not compressed. 

## Included patches:

### EV+IV Checker (HG/SS/PLAT)

When applied, holding R while opening the summary/switching to a pokemon in the summary screen will display IVs instead of stats. L for EVs.

### ButtonScript (HG/SS/PLAT)

ATTENTION: this patch requires you to have an uncompressed overlay (0001 for HG/SS, 0005 for Plat)!

When applied, a given button (default: Start) will execute a script when pressed in the overworld. This is usually used to implement a portable PC, but can be used with other scripts as well.

In HG/SS, the script is set to CommonScript 2072 (Script 73 in Script file 3), in Platinum it is set to CommonScript 2058 (Script 59 in Script file 211).

Neither of these scripts exist in the base game, so you will have to create them yourself. This is intentional, so that you can write a PC script that suppresses animations when called through the button.

You can change the button and the script in the patch before applying.

(more to come)

## Contributing:

If you want to contribute your own patches, you can use the included ones as templates as to what yours are supposed to look like. 

Make sure that:
1. The patch name is clearly labeled with the ROM it is to be applied to (such as "_HG")
2. The patch includes a:
```asm
INJECT_ADDR equ 0x023C8750
.org INJECT_ADDR
```
so that the script is able to adjust the injection address
